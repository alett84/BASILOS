<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BASIL OS: Common Errors</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BASIL OS
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Common Errors </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Here are some of the most common errors people encounter when starting to work on MPX, along with their solutions.</p>
<h1><a class="anchor" id="autotoc_md16"></a>
Implicit Declaration</h1>
<pre class="fragment">$ make
nasm -f elf -g  -o kernel/core-asm.o kernel/core-asm.s
nasm -f elf -g  -o kernel/sys_call_isr.o kernel/sys_call_isr.s
clang @make/CFLAGS   -c -o kernel/core-c.o kernel/core-c.c
clang @make/CFLAGS   -c -o kernel/kmain.o kernel/kmain.c
kernel/kmain.c:91:2: error: implicit declaration of function 'commhand' is invalid in C99 [-Werror,-Wimplicit-function-declaration]
        commhand();
        ^
1 error generated.
make: *** [&lt;builtin&gt;: kernel/kmain.o] Error 1
</pre><p> This is a compiler error (technically a warning, but MPX has instructed the compiler to treat warnings as errors to force you to deal with them) that you are attempting to call a function, or refer to a variable, which hasn't been declared. First, check the spelling of the variable or function name. If you're sure that's correct, the most likely cause is that the variable or function is defined in a different source file, and you forgot to either (1) add the appropriate declaration to the corresponding header file; or (2) <code>#include</code> that header file in the file that is generating the error.</p>
<h1><a class="anchor" id="autotoc_md17"></a>
Undefined Reference</h1>
<pre class="fragment">$ make
nasm -f elf -g  -o kernel/core-asm.o kernel/core-asm.s
nasm -f elf -g  -o kernel/sys_call_isr.o kernel/sys_call_isr.s
clang @make/CFLAGS   -c -o kernel/core-c.o kernel/core-c.c
clang @make/CFLAGS   -c -o kernel/kmain.o kernel/kmain.c
clang @make/CFLAGS   -c -o kernel/serial.o kernel/serial.c
clang @make/CFLAGS   -c -o lib/core.o lib/core.c
clang @make/CFLAGS   -c -o lib/ctype.o lib/ctype.c
clang @make/CFLAGS   -c -o lib/stdlib.o lib/stdlib.c
clang @make/CFLAGS   -c -o lib/string.o lib/string.c
clang @make/CFLAGS   -c -o user/core.o user/core.c
i686-linux-gnu-ld @make/LDFLAGS -o kernel.bin kernel/core-asm.o kernel/sys_call_isr.o kernel/core-c.o kernel/kmain.o kernel/serial.o lib/core.o lib/ctype.o lib/stdlib.o lib/string.o user/core.o
i686-linux-gnu-ld: kernel/kmain.o: in function `kmain':
/home/jkk00010/cs450/mpx/kernel/kmain.c:92: undefined reference to `commhand'
make: *** [Makefile:29: kernel.bin] Error 1
</pre><p> This is a linker error that there is a refernce to a function or variable in at least one object file that is not defined in <em>any</em> object file in MPX. The most likely cause is you have created a new source (.c) file, but didn't add its object file to the list of objects to be built. See the Build section of <code>doc/code-layout.md</code> for instructions on how to add object files to the build.</p>
<h1><a class="anchor" id="autotoc_md18"></a>
Multiple Definitions</h1>
<pre class="fragment">$ make
nasm -f elf -g  -o kernel/core-asm.o kernel/core-asm.s
nasm -f elf -g  -o kernel/sys_call_isr.o kernel/sys_call_isr.s
clang @make/CFLAGS   -c -o kernel/core-c.o kernel/core-c.c
clang @make/CFLAGS   -c -o kernel/kmain.o kernel/kmain.c
clang @make/CFLAGS   -c -o kernel/serial.o kernel/serial.c
clang @make/CFLAGS   -c -o lib/core.o lib/core.c
clang @make/CFLAGS   -c -o lib/ctype.o lib/ctype.c
clang @make/CFLAGS   -c -o lib/stdlib.o lib/stdlib.c
clang @make/CFLAGS   -c -o lib/string.o lib/string.c
clang @make/CFLAGS   -c -o user/core.o user/core.c
i686-linux-gnu-ld @make/LDFLAGS -o kernel.bin kernel/core-asm.o kernel/sys_call_isr.o kernel/core-c.o kernel/kmain.o kernel/serial.o lib/core.o lib/ctype.o lib/stdlib.o lib/string.o user/core.o
i686-linux-gnu-ld: kernel/kmain.o:/home/jkk00010/cs450/mpx/include/sys_req.h:31: multiple definition of `a_global_variable'; kernel/core-c.o:/home/jkk00010/cs450/mpx/include/sys_req.h:31: first defined here
i686-linux-gnu-ld: kernel/serial.o:/home/jkk00010/cs450/mpx/include/sys_req.h:31: multiple definition of `a_global_variable'; kernel/core-c.o:/home/jkk00010/cs450/mpx/include/sys_req.h:31: first defined here
i686-linux-gnu-ld: user/core.o:/home/jkk00010/cs450/mpx/include/sys_req.h:31: multiple definition of `a_global_variable'; kernel/core-c.o:/home/jkk00010/cs450/mpx/include/sys_req.h:31: first defined here
make: *** [Makefile:29: kernel.bin] Error 1
</pre><p> This is a linker error telling you that you have two (or more) functions and/or variables with the same name at global scope in different object files. The most likely source of this error is an improper definition of a global variable. There is an important distinction between a variable <em>declaration</em> and a variable <em>definition</em> in C programs, especially at global scope. When you create a variable, like: </p><pre class="fragment">int some_variable = 0;
</pre><p> This is a <em>definition</em>. The name is reserved, as well as space in the object file to store its value. Contrast: </p><pre class="fragment">extern int some_variable;
</pre><p> This is a <em>declaration</em>. The <code>extern</code> keyword instructs the compiler to reserve the name, but not any space in the object file - that space will be allocated elsewhere.</p>
<p>When placed in a header file, a <em>definition</em> attempts to reserve both the variable name <em>and</em> its space in every object file, resulting in the multiple definition error. In contrast, a <em>declaration</em> in a header file just allows you to access that variable, and can be <code>#include</code>d in as many files as you want.</p>
<p>What you want to do for global variables is put the <em>declaration</em> (i.e. using the <code>extern</code> keyword, without an initial value) in your header file, then place the matching definition (without <code>extern</code>, and as good programming practice, with an explicit initial value) in exactly one source file. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>

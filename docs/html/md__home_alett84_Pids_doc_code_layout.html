<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BASIL OS: MPX Code Layout</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BASIL OS
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">MPX Code Layout </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This file describes the contents of the repository as it is provided to you at the beginning of the semester, with some guidance on how to direct your changes as the semester goes on.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Headers</h1>
<p>Headers for C code are located in the <code>include</code> directory.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Standard Headers</h2>
<p>At the top level of the <code>include</code> directory are headers containing declarations for the handful of provided functions based on the C standard library. These are:</p>
<ul>
<li><code><a class="el" href="ctype_8h.html" title="A subset of standard C library functions.">ctype.h</a></code> &ndash; Character operations</li>
<li><code><a class="el" href="stdlib_8h.html" title="A subset of standard C library functions.">stdlib.h</a></code> &ndash; The <code><a class="el" href="stdlib_8h.html#a30670a60464f77af17dfb353353d6df8">atoi()</a></code> function</li>
<li><code><a class="el" href="string_8h.html" title="A subset of standard C library functions.">string.h</a></code> &ndash; Various memory and string functions</li>
</ul>
<p>You may want to add declarations to these files if you implement additional functions from the standard library. You should <em>not</em> remove or modify any of the existing contents of these files.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
MPX Headers</h2>
<p>MPX-specific headers include those that should only be directly referenced by kernel code, under the <code>include/mpx</code> directory, and those that may also be needed by user-space code. There is no reason to modify most of these headers. You will likely want to add new headers to the <code>include</code> (for user-space) and <code>include/mpx</code> directories as you develop your MPX. The provided files are:</p>
<ul>
<li><code><a class="el" href="processes_8h.html" title="Provided system process and user processes for testing.">processes.h</a></code> &ndash; Declarations for functions that will be loaded as processes</li>
<li><code><a class="el" href="sys__req_8h.html" title="System request function and constants.">sys_req.h</a></code> &ndash; The interface between user-space and kernel-space</li>
<li><code><a class="el" href="device_8h_source.html">mpx/device.h</a></code> &ndash; Constants such as <code>COM1</code></li>
<li><code><a class="el" href="gdt_8h.html" title="Kernel functions to initialize the Global Descriptor Table.">mpx/gdt.h</a></code> &ndash; Functions for the Global Descriptor Table</li>
<li><code><a class="el" href="interrupts_8h.html" title="Kernel functions related to software and hardware interrupts.">mpx/interrupts.h</a></code> &ndash; Functions for dealing with interrupts</li>
<li><code><a class="el" href="io_8h.html" title="Kernel macros to read and write I/O ports.">mpx/io.h</a></code> &ndash; Macros for performing hardware I/O</li>
<li><code><a class="el" href="panic_8h.html" title="Common system functions and definitions.">mpx/panic.h</a></code> &ndash; The kernel panic function</li>
<li><code><a class="el" href="vm_8h.html" title="Kernel functions for virtual memory and primitive allocation.">mpx/vm.h</a></code> &ndash; Virtual memory functions</li>
</ul>
<p>Two headers you may want to add to (but not remove or modify existing contents) are:</p>
<ul>
<li><code><a class="el" href="memory_8h.html" title="MPX-specific dynamic memory functions.">memory.h</a></code> &ndash; The MPX-specific heap manager</li>
<li><code><a class="el" href="serial_8h.html" title="Kernel functions and constants for handling serial I/O.">mpx/serial.h</a></code> &ndash; Functions interacting with serial ports</li>
</ul>
<h1><a class="anchor" id="autotoc_md9"></a>
Source Files</h1>
<p>Source files are located in the <code>kernel</code>, <code>lib</code>, and <code>user</code> directories, according to their use.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
Kernel Files</h2>
<p>Files in the <code>kernel</code> directory are part of the kernel. They execute in kernel-mode, interact directly with hardware, and manage system resources. Provided files are:</p>
<ul>
<li><code>core-asm.s</code> &ndash; Required assembly routines to load the system. Should not be modified.</li>
<li>`core-c.c &ndash; Required C functions to initialize the system. Should not be modified.</li>
<li><code>kmain.c</code> &ndash; Contains the <code>kmain()</code> function that controls overall system functionality. You will need to modify this function in several modules.</li>
<li><code>serial.c</code> &ndash; Contains functions for interacting with serial ports. You will need to modify this file in modules R1 and R6.</li>
<li><code>sys_call_isr.s</code> &ndash; Contains the Interrupt Service Routine linking kernel-space and user-space. You will need to modify this in module R3.</li>
</ul>
<h2><a class="anchor" id="autotoc_md11"></a>
Library Files</h2>
<p>Files in the <code>lib</code> directory contain functionality that can be used by both kernel-space and user-space code. Provided files are:</p>
<ul>
<li><code>core.c</code> &ndash; Functions required to be present by the compiler along with the basic MPX heap manager. Should not be modified.</li>
<li><code>ctype.c</code> &ndash; Functions declared in <code>&lt;<a class="el" href="ctype_8h.html" title="A subset of standard C library functions.">ctype.h</a>&gt;</code>.</li>
<li><code>stdlib.c</code> &ndash; Functions declared in <code>&lt;<a class="el" href="stdlib_8h.html" title="A subset of standard C library functions.">stdlib.h</a>&gt;</code>.</li>
<li><code>string.c</code> &ndash; Functions declared in <code>&lt;<a class="el" href="string_8h.html" title="A subset of standard C library functions.">string.h</a>&gt;</code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md12"></a>
User Files</h2>
<p>Files in the <code>user</code> directory form the MPX user-space. These are the Command Handler (which you must design and implement) along with its various commands, along with several processes used in testing your module implementations and the <code><a class="el" href="sys__req_8h.html#a0826d3da32611e0fc48b5d9cbe6c6e26">sys_req()</a></code> function, which links user-space to kernel-space. The only provided file is:</p>
<ul>
<li><code>core.c</code> &ndash; Contains <code><a class="el" href="sys__req_8h.html#a0826d3da32611e0fc48b5d9cbe6c6e26">sys_req()</a></code> and functions for processes needed in R3 and R4. Should not be modified.</li>
</ul>
<h1><a class="anchor" id="autotoc_md13"></a>
Build Files</h1>
<p>MPX uses the POSIX standard <code>make</code> utility to automate compilation and linking. While in the top level directory of your repository, you can build MPX by running: </p><pre class="fragment">make
</pre><p> You can remove build artifacts and force the next build to recompile all source files by running: </p><pre class="fragment">make clean
</pre><p> The build process is controlled by several files. Several of these should not be changed:</p>
<ul>
<li><code>Makefile</code> &ndash; The primary configuration file.</li>
<li><code>make/CFLAGS</code> &ndash; Options passed to the compiler to ensure proper creation of a standalone 32-bit x86 kernel.</li>
<li><code>make/LDFLAGS</code> &ndash; Options passed to the linker to ensure proper creation of a standalone 32-bit x86 kernel.</li>
<li><code>make/link.ld</code> &ndash; A script providing additional information beyond what can be included in <code>make/LDFLAGS</code> directly necessary for proper creation of a standalone 32-bit x86 kernel.</li>
<li><code>make/deps.sh</code> &ndash; Generates the lists of object files and dependencies (below).</li>
</ul>
<p>Other files <em>will</em> require updating as you add and modify your own source files:</p>
<ul>
<li><code>make/kernel.mk</code> &ndash; Kernel objects and their dependencies.</li>
<li><code>make/lib.mk</code> &ndash; Library objects and their dependencies.</li>
<li><code>make/user.mk</code> &ndash; User objects and their dependencies.</li>
</ul>
<p>To update these files, run: </p><pre class="fragment">make deps
</pre> <h1><a class="anchor" id="autotoc_md14"></a>
Other Files</h1>
<p>The remaining files are not source code or used directly in the build process. They are:</p>
<ul>
<li><code>doc/</code> &ndash; (Directory) Contains documentation. You will add your own documentation to this directory.</li>
<li><code>.github/workflows/makefile.yml</code> - Contains a GitHub action that attempts to compile your code whenever you push it to GitHub. If it doesn't compile on GitHub, it is not likely to compile in the test environment (barring compilation failures due to network issues). This file should not be modified.</li>
<li><code>.gitignore</code> &ndash; Instructs Git to ignore object files and your compiled kernel when considering what has changed in your repository. You may want to add lines to this file if your team's workflow involves additional artifacts that should not be in the repository.</li>
<li><code>mpx.sh</code> &ndash; A POSIX shell script that executes MPX in a QEMU virtual machine with appropriate options for serial I/O and attaching a debugger, and resetting the terminal afterward. Should not be changed. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
